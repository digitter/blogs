---
marp: true
paginate: true
footer: "by kazuki tanida"
---

<!-- prerender: true -->
<!-- class: invert -->

## Puma vs Unicorn

>どちらも一つのアプリケーションサーバーであり、
>複数のRailsのプロセスを起動している。

---

## マルチスレッドとマルチプロセス

Unicornはプロセスごとに通信処理をおこなうので、重たい通信があった場合そこでブロックされて全体が重くなってしまいます。
これをさばけるようにするにはUnicornのworker数を増やす必要があるのですが、CPUのコアの数による処理制限があるためむやみには増やせません。

Pumaはマルチスレッドで動くので、プロセスを増やす必要がないため、リソースが少ない中でも効率的にリクエストをさばくことが可能になります。

詳細リンク
>https://moro-archive.hatenablog.com/entry/2014/09/11/013520

---

|サーバー|プロセス|メモリ|
|---|---|---
|puma|マルチスレッド化|共有する|
|unicorn|マルチプロセス化|占有する|

### マルチプロセス
- 子プロセスを立ち上げたときには子プロセス用のメモリ領域が新たに割り当てられます。

### マルチスレッド
- スレッドが生成された時には親プロセスの仮想アドレス空間内に、スレッド毎に情報をコピーして利用します。つまり、親プロセスの領域の中に全てのスレッドが存在していることになります。

