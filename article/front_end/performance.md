---
marp: true
header: "**Tech mesia**"
paginate: true
footer: "by kazuki tanida"
---

---

## レンダリングの流れ

---

- リソースのダウンロード
> HTML, CSS, JSファイルのダウンロード
- オブジェクトモデルの構築
>HTML => DOMの構成 / CSS => CSSOMの構成
- JavaScriptの実行
- レンダリングツリーの構築
>*レンダリングツリーによってDOM, CSSOMがlinkされる
- レンダリングツリーのレイアウト
>x, y, z軸などの解析
- レンダリングツリーの描画
>ペイント: 色付け
>コンポジット: pixelで書き出したレイアウトの合成(CPUやGPUの役割)

---
<!-- prerender: true -->

## フロントエンドのパフォーマンス
- DOMContentLoadedイベント - DOMの構築完了時のイベント
>JSがDOM処理を行うのに適したタイミング.
>つまりDOMLoadedイベントを早く実行させることが、他のコードの実行をもはやくさせる。

---

- scriptタグ読み込まれた時点ではDOMの構成がブロックされる。
>即時関数のjsのコード自体がscriptタグを作った時はdom構築をブロックせずに非同期的に読み込みが起こる。

- CSSOMはレンダリングをブロックする
>DOMLoadedイベントが起こった時点でCSSOMの構築が完了している保証はない.
> - Firefox
>headタグ内のlinkでcssを読むとき、bodyタグないのcssはレンダリングをブロックしない
>bodyタグ内にlinkを書いても同じ動作をする。

> - Chrome
>対してChromeはbodyタグないのcssはレンダリングをブロックする。
>cssが表示されるのを保証するという方針からそのような挙動になるらしい。

bodyタグ内でのCSS読み込みはブラウザによっても動作が標準化されていないので積極的な利用はお勧めできない。

---

- JSで動的にlinkタグを生成しCSSを読み込むと、レンダリングをブロックしない。

でも、CSSの適用されていない画面が一定時間出ることを考えるとUX的には良くない。(最低限の利用に止めよう)

---

cssのstyleタグ利用、インライン化ではキャッシュ不能になるので、
肥大化するとHTMLの読み込み自体が遅くなるので注意しなければいけない。


---

## jsとcssを読み込むとき

### case1
cssファイル読み込みに3秒
jsファイル読み込みに5秒かかる場合
```
css--->
js -----> DomContentLoaded
```

### case2
cssファイル読み込みに3秒
即時関数でscriptタグを生成しjsファイルを読み込み
```
css--->js-----> DomContentLoaded
```
>jsの実行はCSSOMが構築された状態でしか実行ができない!!!

---

## プリロード機能
jsのコードは実行できない
